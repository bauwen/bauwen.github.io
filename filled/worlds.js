levels = [
    "oooooooooooooooo" +
    "oooooooooooooooo" +
    "ooooo######ooooo" +
    "ooooo#....#ooooo" +
    "ooooo#.@x.#ooooo" +
    "ooooo#....#ooooo" +
    "ooooo######ooooo" +
    "oooooooooooooooo" +
    "oooooooooooooooo",

    "oooooooooooooooo" +
    "oooooooooooooooo" +
    "oooo########oooo" +
    "oooo##...#x#oooo" +
    "oooo#..#.@.#oooo" +
    "oooo#......#oooo" +
    "oooo########oooo" +
    "oooooooooooooooo" +
    "oooooooooooooooo",

    "oooooooooooooooo" +
    "oooo########oooo" +
    "oooo#....x@#oooo" +
    "oooo#......#oooo" +
    "oooo#......#oooo" +
    "oooo#.#..#.#oooo" +
    "oooo#......#oooo" +
    "oooo########oooo" +
    "oooooooooooooooo",

    "oooooooooooooooo" +
    "ooo##########ooo" +
    "ooo#.......##ooo" +
    "ooo#.....#.@#ooo" +
    "ooo#....x...#ooo" +
    "ooo###....#.#ooo" +
    "ooo###......#ooo" +
    "ooo##########ooo" +
    "oooooooooooooooo",

    "oooooooooooooooo" +
    "oooooooooooooooo" +
    "ooo##########ooo" +
    "ooo#.......@#ooo" +
    "ooo#..#.....#ooo" +
    "ooo##.....#.#ooo" +
    "ooo#x.......#ooo" +
    "ooo##########ooo" +
    "oooooooooooooooo",

    "oooooooooooooooo" +
    "################" +
    "##........x....#" +
    "#..###....###..#" +
    "#..#@#.####....#" +
    "#..#...#.......#" +
    "#........####..#" +
    "################" +
    "oooooooooooooooo",

    "################" +
    "######.......###" +
    "####..x.......@#" +
    "##.............#" +
    "##..####...##..#" +
    "#...###...###..#" +
    "#.......#....#.#" +
    "############...#" +
    "################",

    "oooooooooooooooo" +
    "oooo########oooo" +
    "oooo#...##@#oooo" +
    "oooo#.#.##.#oooo" +
    "oooo#..%...#oooo" +
    "oooo###.##x#oooo" +
    "oooo###....#oooo" +
    "oooo########oooo" +
    "oooooooooooooooo",

    "oooooooooooooooo" +
    "oooooooooooooooo" +
    "ooo##########ooo" +
    "ooo#@x.....##ooo" +
    "ooo#..%.##..#ooo" +
    "ooo#........#ooo" +
    "ooo##########ooo" +
    "oooooooooooooooo" +
    "oooooooooooooooo",

    "oooooooooooooooo" +
    "oooooooooooooooo" +
    "oo############oo" +
    "oo#......##x.#oo" +
    "oo#.#.%......#oo" +
    "oo#....#...%.#oo" +
    "oo##.@##....##oo" +
    "oo############oo" +
    "oooooooooooooooo",

    "oooooooooooooooo" +
    "o##############o" +
    "o#..#......####o" +
    "o#@..%%......##o" +
    "o#.....##....##o" +
    "o#.#..##.%.%.##o" +
    "o#x##.......###o" +
    "o##############o" +
    "oooooooooooooooo",

    "oooooooooooooooo" +
    "oooooooooooooooo" +
    "oooo########oooo" +
    "oooo#..##1.#oooo" +
    "oooo#.x##..#oooo" +
    "oooo#.1##.@#oooo" +
    "oooo########oooo" +
    "oooooooooooooooo" +
    "oooooooooooooooo",

    "oooooooooooooooo" +
    "################" +
    "#..#..........1#" +
    "#...%.........x#" +
    "#.1........#...#" +
    "#.@..........#.#" +
    "#..............#" +
    "################" +
    "oooooooooooooooo",

    "oooooooooooooooo" +
    "oooooooooooooooo" +
    "################" +
    "#3.12.###.@....#" +
    "####..1........#" +
    "#x.2.......###.#" +
    "####.....3.....#" +
    "################" +
    "oooooooooooooooo",

    "o##############o" +
    "o##.2.......###o" +
    "o#..#.#1.%..###o" +
    "o#....#.....###o" +
    "o##############o" +
    "o###2.........#o" +
    "o###@...%%%..x#o" +
    "o###.....1...##o" +
    "o##############o",

    "oooooooooooooooo" +
    "o##############o" +
    "o#........2..##o" +
    "o#1#@.......%.#o" +
    "o#..x##....#..#o" +
    "o#.%..2......1#o" +
    "o##...##......#o" +
    "o##############o" +
    "oooooooooooooooo",

    "################" +
    "##.............#" +
    "##....#...####.#" +
    "##......#.#..#.#" +
    "##..#..##.#x...#" +
    "#...#...#@###..#" +
    "#...#..........#" +
    "#..............#" +
    "################",

    "ooo##########ooo" +
    "ooo#........#ooo" +
    "ooo#.##.....#ooo" +
    "ooo#.#@.#1..#ooo" +
    "ooo#x...##..#ooo" +
    "ooo#..1##.%.#ooo" +
    "ooo#.......##ooo" +
    "ooo#..#....##ooo" +
    "ooo##########ooo",

    "oooooooooooooooo" +
    "################" +
    "#####.1........#" +
    "#.....#........#" +
    "#...#3x.3####..#" +
    "#.##........#..#" +
    "#.22.......@1..#" +
    "################" +
    "oooooooooooooooo",

    "################" +
    "#.............@#" +
    "#.###.....#....#" +
    "#.#...#..##....#" +
    "#......#.x.....#" +
    "#....#...##..#.#" +
    "#..###..#..###.#" +
    "##.............#" +
    "################",

    "################" +
    "##.....##....x3#" +
    "#1....%@#......#" +
    "###....##..4...#" +
    "###..####..##..#" +
    "##...####..##..#" +
    "##..%..2#....4.#" +
    "#2...3.1#......#" +
    "################",

    "oooooooooooooooo" +
    "o##############o" +
    "o#1....x.....2#o" +
    "o###.%...##..##o" +
    "o#....##@#3...#o" +
    "o#....3#......#o" +
    "o###........###o" +
    "o#2..........1#o" +
    "o##############o",

    "################" +
    "#............1x#" +
    "#.##...........#" +
    "#.#..##..##....#" +
    "#..............#" +
    "#....#.@###..#.#" +
    "#............#.#" +
    "#1.............#" +
    "################",

    "oooooooooooooooo" +
    "oooooooooooooooo" +
    "o##############o" +
    "o#@#...2...#1##o" +
    "o#.3..1..#43.##o" +
    "o##5%%.....#4##o" +
    "o#x2.5.......##o" +
    "o##############o" +
    "oooooooooooooooo",

    "################" +
    "###........#####" +
    "#......#.......#" +
    "#.##..%.%..%...#" +
    "#...%..#.##...##" +
    "#....#..%...%.##" +
    "#...%......#..##" +
    "##@#x.........##" +
    "################",

    "################" +
    "###....##4....1#" +
    "##x....##......#" +
    "#......##..##..#" +
    "#@##...##.2##2.#" +
    "####...##..##..#" +
    "####...##......#" +
    "####.31##...43.#" +
    "################",

    "################" +
    "#@#..##......###" +
    "#...%.#.......##" +
    "##.....#.......#" +
    "###..#.........#" +
    "#......#..#.#.##" +
    "#....#...#....##" +
    "##.........#..x#" +
    "################",

    "oooooooooooooooo" +
    "################" +
    "#.......#@#....#" +
    "#....1....#...2#" +
    "#3.....#.......#" +
    "#........1.....#" +
    "##..2##........#" +
    "#x...##....3...#" +
    "################",

    "o##############o" +
    "o##...........#o" +
    "o#..##......#.#o" +
    "o#.....###..#.#o" +
    "o#.......#..#.#o" +
    "o#.####.......#o" +
    "o#.1#.....##..#o" +
    "o#@...x......1#o" +
    "o##############o",

    "################" +
    "#@...###########" +
    "#....######45###" +
    "#...1###########" +
    "#########12#####" +
    "################" +
    "##23############" +
    "#######34####5x#" +
    "################",
]

worlds = world.create({
    enter: function () {
        levelUnlocked[currentLevel] = true;

        var level = levels[currentLevel++];

        levelCount = 0;
        rightArea = 0;
        topArea = 480;
        leftArea = 640;
        bottomArea = 0;

        for (var i = 0, len = level.length; i < len; i++) {
            var x = 64 + i % 16 * 32 - 8;
            var y = 128 + Math.floor(i / 16) * 32 - 8;
            var char = level.charAt(i);

            switch (char) {
                case "#":
                    if (x > rightArea) rightArea = x;
                    if (y < topArea) topArea = y;
                    if (x < leftArea) leftArea = x;
                    if (y > bottomArea) bottomArea = y;
                    object.create(x, y, obj_wall);
                    break;

                case "@":
                    Player = object.create(x, y, obj_player);
                    break;

                case "%":
                    levelCount += 2;
                    object.create(x, y, obj_bridge);
                    break;

                case "x":
                    levelCount += 1;
                    object.create(x, y, obj_cross);
                    break;

                case ".":
                    levelCount += 1;
                    break;

                case "o":
                    break;

                default:
                    levelCount += 1;
                    object.create(x, y, obj_hole).spriteImage = parseInt(char) - 1;
                    break;
            }
        }

        rightArea += 32;
        bottomArea += 32;
        levelCompleted = false;
        object.create(32, 32, obj_controller);
        object.create(64, 32, obj_fade);

        for (var i = 0; i < 20; i++)
            object.create(math.random(world.width), math.random(world.height), obj_particle);
    }
}, 640, 480, color.make(90, 180, 240));
